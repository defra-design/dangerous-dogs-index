{% extends "layouts/defra.html" %}

{% set pageName="Dog ED17343" %}

{% block pageTitle %}
  {{ pageName }} â€“ {{ serviceName }}
{% endblock %}

<div class="govuk-main-wrapper">

{% block beforeContent %}
  {{ govukBackLink({
    text: "Back",
    href: "javascript:window.history.back()"
  }) }}

  <script>

    window.onload = function() {
    function updateStatus(x, y, z){
      if(localStorage.getItem(z) !== null) {
        document.getElementById(y).innerHTML = "Completed";
        document.getElementById(y).className = "govuk-task-list__status";
      }
    }

    // Function calls
    updateStatus('task1Finished', 'task-1-status', 'task1Started')
    updateStatus('task2Finished', 'task-2-status', 'task2Started')
  }
  </script>

{% endblock %}

{% block pageScripts %}
<script src="/public/javascripts/status-update.js"></script>
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-three-quarters">

      <div class="moj-page-header-actions govuk-!-margin-bottom-2">

        <div class="moj-page-header-actions__title">
          <h1 class="govuk-heading-xl">{{ pageName }}</h1>
        </div>

    <div class="moj-page-header-actions__actions">

      <div class="moj-button-menu">
        <div class="moj-button-menu__wrapper">

          <button type="submit" class="govuk-button moj-button-menu__item govuk-button--secondary moj-page-header-actions__action" data-module="govuk-button">
            Dog record
          </button>

          <button type="submit" class="govuk-button moj-button-menu__item govuk-button--secondary moj-page-header-actions__action" data-module="govuk-button">
            Owner record
          </button>

        </div>
      </div>

    </div>

  </div>
  {{govukTag({
    text: "Pre-exempt"
  })}}

    <form class="form" action="/v6/cdo/manage/cdo-completed" method="post">

      <h2 class="govuk-heading-m govuk-!-margin-top-7 govuk-!-margin-bottom-2">
        First task
      </h2>

      <ul class="govuk-task-list">
        <li class="govuk-task-list__item govuk-task-list__item--with-link">
        <div class="govuk-task-list__name-and-hint">
          <a class="govuk-link govuk-task-list__link govuk-link--no-visited-state" href="application-pack" aria-describedby="task-1-status" onclick="updateLocalStorage('task1Started')">Send application pack</a>
        </div>
        <div class="govuk-task-list__status" id="task-1-status">
          <strong class="govuk-tag govuk-tag--blue">
            Incomplete
          </strong>
        </div>
        </li>
      </ul>

      <h2 class="govuk-heading-m govuk-!-margin-top-7 govuk-!-margin-bottom-2">
        Second set of tasks
      </h2>

      {{ govukTaskList({
        idPrefix: "cdo-tasks-2",
        items: [
          {
            title: {
              text: "Record insurance details"
            },
            status: {
              text: "Cannot start yet",
              classes: "govuk-task-list__status--cannot-start-yet"
            }
          },
          {
            title: {
              text: "Send Form 2"
            },
            status: {
              text: "Cannot start yet",
              classes: "govuk-task-list__status--cannot-start-yet"
            }
          },
          {
            title: {
              text: "Verify microchip and confirm neutering"
            },
            status: {
              text: "Cannot start yet",
              classes: "govuk-task-list__status--cannot-start-yet"
            }
          },
          {
            title: {
              text: "Record payment"
            },
            status: {
              text: "Cannot start yet",
              classes: "govuk-task-list__status--cannot-start-yet"
            }
          },
          {
            title: {
              text: "Issue certificate"
            },
            status: {
              text: "Cannot start yet",
              classes: "govuk-task-list__status--cannot-start-yet"
            }
          }
        ]
      }) }}

      <button class="govuk-button" data-module="govuk-button">
        Complete tasks
      </button>

      </form>

      </div>
    </div>
  </div>

{% endblock %}
